
–í–æ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç README-—Ñ–∞–π–ª–∞ ‚Äî –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ, —Å–æ –≤—Å–µ–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, —é–∑–∫–µ–π—Å–∞–º–∏ –∏ –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º REST API. –ú–æ–∂–µ—à—å –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª–∏–∫–æ–º –≤ `README.md`.

```markdown
# Tracking Service (macOS-friendly README)

> üöö **Tracking Service** ‚Äî —É—á–µ–±–Ω—ã–π backend –Ω–∞ Go, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –∫—É—Ä—å–µ—Ä—Å–∫–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏. –°—Ç–µ–∫: PostgreSQL + PostGIS, Gin, zap, Docker.

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
| –ì—Ä—É–ø–ø–∞ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|--------|-------------|
| –Ø–∑—ã–∫ | **Go 1.23.1 (darwin/arm64)** |
| –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ | **Gin** |
| –ë–∞–∑–∞ | **PostgreSQL 15.4 + PostGIS 3.3.4** (SRID 4326) |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | **uber-zap** (JSON) |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API | **swaggo/swag** ‚Üí Swagger UI `/docs/` |
| –¢–µ—Å—Ç—ã | `testing`, **dockertest**, **GoMock** |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã | **Docker 28.0.1**, `docker-compose` |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```

entity ‚Üí repository ‚Üí service ‚Üí controller (Gin) ‚Üí REST

```
* –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ —à–∞–±–ª–æ–Ω—É **Go Clean Template** –æ—Ç Evrone.  
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostGIS: `ST_DWithin`, `ST_MakePoint` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫—É—Ä—å–µ—Ä–æ–≤.

![layers](docs/img/architecture_layers.png)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/<you>/tracking_service.git
cd tracking_service/backend

# 2. –ü–æ–¥—Ç—è–≥–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod tidy

# 3. –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker compose build app

# 4. –ó–∞–ø—É—Å–∫ —Å—Ç–µ–∫–∞ (Postgres + –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
docker compose up -d

# 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º
curl http://localhost:8080/health   # {"status":"ok"}
```

> –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ entrypoint-—Å–∫—Ä–∏–ø—Ç–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±–∞–∑—ã.

---

## ‚úÖ –¢–µ—Å—Ç—ã –∏ –º–æ–∫–∏

| –¢–∏–ø                                  | –ö–æ–º–∞–Ω–¥–∞                                                      |
| --------------------------------------- | ------------------------------------------------------------------- |
| **Unit**                          | `go test ./tests/unit -v`                                         |
| **Integration**                   | `go test ./tests/integration -tags=integration -v -timeout 10m`   |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ–∫–æ–≤** | `go install go.uber.org/mock/mockgen@latest && go generate ./...` |

---

## üõ†Ô∏è –í–µ—Ä—Å–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç    | –í–µ—Ä—Å–∏—è |
| --------------------- | ------------ |
| PostgreSQL            | 15.4         |
| PostGIS               | 3.3.4        |
| Docker Engine         | 28.0.1       |
| Go (–ª–æ–∫–∞–ª—å–Ω–æ) | 1.23.1       |

---

## üìö –Æ–∑–∫–µ–π—Å—ã

| –ê–∫—Ç—ë—Ä             | –®–∞–≥–∏                                                                                                | –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã                                                       |
| ---------------------- | ------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| **–ö–ª–∏–µ–Ω—Ç** | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –õ–æ–≥–∏–Ω ‚Üí –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ ‚Üí –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å    | `/register`,`/login`,`POST /orders`,`GET /orders/{id}`           |
| **–ö—É—Ä—å–µ—Ä** | –õ–æ–≥–∏–Ω ‚Üí –ü—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑ ‚Üí –ê–ø–¥–µ–π—Ç —Å—Ç–∞—Ç—É—Å–∞ ‚Üí –°—Ç—Ä–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç | `/login`,`PUT /couriers/{id}/status`,`PUT /couriers/{id}/location` |
| **–ê–¥–º–∏–Ω**   | CRUD –∫—É—Ä—å–µ—Ä–æ–≤, –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤                                                  | `/couriers/*`,`/orders/*`                                            |

---

## üåê REST API ‚Äî –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

> –í—Å–µ –æ—Ç–≤–µ—Ç—ã ‚Äî `application/json`; –¥–∞—Ç—ã –≤ RFC 3339. –î–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –Ω—É–∂–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <JWT>`.

### –û–±—â–µ–µ —Ç–µ–ª–æ –æ—à–∏–±–∫–∏

```json
{ "error": "not_found", "message": "order not found" }
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

| –ú–µ—Ç–æ–¥     | URL           | –ö–æ–¥ | –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞                                     | –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞  |
| -------------- | ------------- | ------ | ----------------------------------------------------------- | ---------------------- |
| **POST** | `/register` | 201    | `{ "email": "string", "password": "string", "role": "CLIENT | COURIER                |
| **POST** | `/login`    | 200    | `{ "email": "string", "password": "string" }`             | `{ "token": "jwt" }` |

### –ó–∞–∫–∞–∑—ã

| –ú–µ—Ç–æ–¥       | URL              | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
| ---------------- | ---------------- | ------ | -------------------------------------------------- |
| **GET**    | `/orders`      | 200    | –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (ADMIN)                |
| **POST**   | `/orders`      | 201    | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (CLIENT)                 |
| **GET**    | `/orders/{id}` | 200    | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ (CLIENT/ADMIN)         |
| **PUT**    | `/orders/{id}` | 200    | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑ (–ø–æ–∫–∞ `CREATED`) |
| **DELETE** | `/orders/{id}` | 200    | –£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ (–ø–æ–∫–∞ `CREATED`)   |

```json
{
  "client_id": "uuid",
  "delivery_address": "string",
  "delivery_coords": "<lat>,<lon>",
  "status": "CREATED|ASSIGNED|IN_TRANSIT|DELIVERED|CANCELED"
}
```

### –ö—É—Ä—å–µ—Ä—ã

| –ú–µ—Ç–æ–¥    | URL                                                                  | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                                  |
| ------------- | -------------------------------------------------------------------- | ------ | ----------------------------------------------------------------- |
| **GET** | `/couriers/nearest?latitude={lat}&longitude={lon}&radius={meters}` | 200    | –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤ |
| **GET** | `/couriers/{id}`                                                   | 200    | –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫—É—Ä—å–µ—Ä–∞ (ADMIN)              |
| **PUT** | `/couriers/{id}/status`                                            | 200    | –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å (`AVAILABLE                         |
| **PUT** | `/couriers/{id}/location`                                          | 200    | –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫—É—Ä—å–µ—Ä–∞              |

```json
// /couriers/{id}/status
{ "status": "AVAILABLE" }

// /couriers/{id}/location
{ "latitude": 55.75, "longitude": 37.61 }
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ

| –ú–µ—Ç–æ–¥    | URL         | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| ------------- | ----------- | ------ | ---------------------------------------------------- |
| **GET** | `/health` | 200    | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ |


### –ò—Ç–æ–≥–æ–≤—ã–π –Ω–∞–±–æ—Ä –±–∞–ª–ª–æ–≤ 

| –ü—É–Ω–∫—Ç                                                                                         | –ë–∞–ª–ª—ã   | –ü–æ—á–µ–º—É –∑–∞—Å—á–∏—Ç–∞–Ω–æ                                                                                                                                  |
| -------------------------------------------------------------------------------------------------- | ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–µ—Å—è—Ç–∫–∞ (–∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º—É–º 10)** | **10** | README, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤, –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫–∞, —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–û–û–ü-—Å–ª–æ–∏), unit + integration-—Ç–µ—Å—Ç—ã |
| **REST API (‚â• 4 —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤)**                                                     | **10** | Gin-—Ä–æ—É—Ç—ã `/register`,`/login`,`/orders/*`,`/couriers/*`                                                                                            |
| **–†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö**                                                  | **10** | PostgreSQL 15 + PostGIS 3.3, –º–∏–≥—Ä–∞—Ü–∏–∏, –∏–Ω–¥–µ–∫—Å—ã GIST                                                                                               |
| **–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**                                                  | **5**  | `config.Config`+ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`SERVER_PORT`,`DATABASE_URL`,`JWT_SECRET`,`LOG_LEVEL`‚Ä¶)                                     |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**                                                                   | **2**  | zap-middleware c —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–æ–≤                                                                                                                       |
| **Docker-–æ–±—Ä–∞–∑**                                                                        | **5**  | Multi-stage `Dockerfile`+`docker-compose.yml`                                                                                                                |
